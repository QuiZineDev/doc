@startuml
hide circle
skinparam linetype ortho

entity "user" {
  + id : INTEGER <<PK>> <<generated>>
  --
  username : VARCHAR(255) <<NN>>
  password : VARCHAR(255) <<NN>>
  picture : BYTEA
  admin : BOOLEAN <<NN>> <<default false>>
}

entity "amis" {
  + id_requestor : INTEGER <<PK>> <<FK>>
  + id_validator : INTEGER <<PK>> <<FK>>
}

entity "game_request" {
  + id_session : INTEGER <<PK>> <<FK>>
  + id_requestor : INTEGER <<PK>> <<FK>>
  + id_validator : INTEGER <<PK>> <<FK>>
  --
  datetime : TIMESTAMP <<NN>> <<UNIQUE>> <<default now()>>
}

entity "session" {
  + id : INTEGER <<PK>> <<generated>>
  --
  id_quiz : INTEGER <<NN>> <<FK>>
}

entity "quiz" {
  + id : INTEGER <<PK>> <<generated>>
  --
  nom : VARCHAR(255) <<NN>>
  picture : BYTEA
  private : BOOLEAN <<NN>> <<default true>>
  id_creator : INTEGER <<FK>>
}

entity "labelisable" {
  + id : INTEGER <<PK>> <<generated>>
}

entity "question" {
  + id : INTEGER <<PK>> <<generated>>
  --
  name : VARCHAR(255) <<NN>>
  id_answer : INTEGER <<NN>> <<FK>>
  grade : INTEGER
  picture : BYTEA
  duration : INTEGER
  id_creator : INTEGER <<FK>>
  private : BOOLEAN <<NN>> <<default true>>
}

entity "choice" {
  + id : INTEGER <<PK>> <<generated>>
  --
  content : VARCHAR(255) <<NN>>
  id_question : INTEGER <<NN>> <<FK>>
}

entity "nn_quiz_question" {
  + id_quiz : INTEGER <<PK>> <<FK>> <<generated>>
  + id_question : INTEGER <<PK>> <<FK>>
}

entity "label" {
  + id : INTEGER <<PK>> <<generated>>
  --
  nom : VARCHAR(255) <<NN>>
}

entity "nn_label_labelisable" {
  + id_label : INTEGER <<PK>> <<FK>> <<generated>>
  + id_labelisable : INTEGER <<PK>> <<FK>>
}

entity "participation" {
  + id : INTEGER <<PK>> <<generated>>
  --
  id_session : INTEGER <<NN>> <<FK>>
  id_user : INTEGER <<NN>> <<FK>>
  datetime : TIMESTAMP <<NN>> <<default now()>>
  score : INTEGER
}

entity "answers" {
  + id : INTEGER <<PK>> <<generated>>
  --
  id_participation : INTEGER <<NN>> <<FK>>
  id_question : INTEGER <<NN>> <<FK>>
  id_decision : INTEGER <<NN>> <<FK>>
  duration : INTEGER
}

entity "friend_request" {
  + id_requestor : INTEGER <<PK>> <<FK>> <<generated>>
  + id_validator : INTEGER <<PK>> <<FK>>
  --
  datetime : TIMESTAMP <<NN>> <<default now()>>
}

entity "modification_request" {
  + id_requestor : INTEGER <<PK>> <<FK>> <<generated>>
  + id_creator : INTEGER <<PK>> <<FK>>
  + id_question : INTEGER <<PK>> <<FK>>
  --
  message : VARCHAR(255) <<NN>>
  status : BOOLEAN <<NN>> <<default false>>
}

entity "comment" {
  + id_creator : INTEGER <<PK>> <<FK>> <<generated>>
  + id_quiz : INTEGER <<PK>> <<FK>>
  --
  message : VARCHAR(255) <<NN>>
  datetime : TIMESTAMP <<NN>>
}

entity "grade" {
  + id_creator : INTEGER <<PK>> <<FK>> <<generated>>
  + id_labelisable : INTEGER <<PK>> <<FK>>
  --
  grade : DOUBLE PRECISION <<NN>> <<default 0>>
}

"user"                       ||--o{ "amis"                : "id_requestor"
"user"                       ||--o{ "amis"                : "id_validator"
"user"                       ||--o{ "game_request"        : "id_requestor"
"user"                       ||--o{ "game_request"        : "id_validator"
"session"                    ||--o{ "game_request"        : "id_session"
"user"                       ||--o{ "quiz"                : "id_creator"
"quiz"                       ||--o{ "session"             : "id_quiz"
"quiz"                       }|--|| "labelisable"         : "id"
"user"                       ||--o{ "question"            : "id_creator"
"choice"                     }|--o| "question"            : "id_answer"
"question"                   ||--o{ "choice"              : "id_question"
"labelisable"                }|--|| "question"            : "id"
"question"                   ||--o{ "nn_quiz_question"    : "id_question"
"quiz"                       ||--o{ "nn_quiz_question"    : "id_quiz"
"label"                      ||--o{ "nn_label_labelisable": "id_label"
"labelisable"                ||--o{ "nn_label_labelisable": "id_labelisable"
"user"                       ||--o{ "participation"       : "id_user"
"session"                    ||--o{ "participation"       : "id_session"
"participation"              ||--o{ "answers"             : "id_participation"
"question"                   ||--o{ "answers"             : "id_question"
"choice"                     ||--o{ "answers"             : "id_decision"
"user"                       ||--o{ "friend_request"      : "id_requestor"
"user"                       ||--o{ "friend_request"      : "id_validator"
"question"                   ||--o{ "modification_request": "id_question"
"user"                       ||--o{ "modification_request": "id_creator"
"user"                       ||--o{ "modification_request": "id_requestor"
"user"                       ||--o{ "comment"             : "id_creator"
"quiz"                       ||--o{ "comment"             : "id_quiz"
"user"                       ||--o{ "grade"               : "id_creator"
"labelisable"                ||--o{ "grade"               : "id_labelisable"

@enduml